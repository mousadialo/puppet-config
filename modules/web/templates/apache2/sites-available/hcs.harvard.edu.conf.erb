<VirtualHost *:80>
  ServerName  www.hcs.harvard.edu
  ServerAlias <%= @secondary_domains.map{ |domain| "www." + domain }.join(" ") %> hcs.harvard.edu <%= @secondary_domains.join(" ") %>

  # Always canonicalize host to www.hcs.harvard.edu
  RewriteEngine  On
  RewriteOptions Inherit
  RewriteCond %{HTTP_HOST} !^www\.hcs\.harvard\.edu$ [NC]  # [NC]: case-insensitive
  RewriteRule ^ http://www.hcs.harvard.edu%{REQUEST_URI} [R=301,L]
  UseCanonicalName On

  DocumentRoot /var/www/hcs.harvard.edu/htdocs
  ServerAdmin  webmaster@hcs

  <Directory "/var/www/hcs.harvard.edu/htdocs">
    Options Indexes FollowSymLinks MultiViews
    AllowOverride All
    Require all granted
  </Directory>

  # Non-secure web pages should use the files in hcs-nonsecure-conf
  # as well as the general configuration files in hcs-conf
  Include /etc/apache2/hcs-conf/[^.#]*
  Include /etc/apache2/hcs-nonsecure-conf/[^.#]*
</VirtualHost>

